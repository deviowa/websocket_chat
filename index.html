<html>
    <head>
      
      <link rel="stylesheet" href="/css/bootstrap.min.css">
      <link rel="stylesheet" href="/css/style.css">
      
    </head>    
    <body>





        <div class="container">
          <div class="row">
            <div id="output" class="well chatbox col-md-8">
              <h1>Welcome to Chat</h1>
            </div>
            <div class="col-md-4">
            </div>
            <div class="col-md-8 .affix-bottom">
                <form role="form">
                  <div class="row table">
                    <input type="text" id="input" class="form-control inline chat-input cell" placeholder="What's on your mind?">
                    <button id="send_button" class="btn btn-default inline cell">send</button>
                  </div>
                </form>
            </div>
            <div class="col=md=4">
            </div>
          </div>
          </div>
        </div>







        <script src="/socket.io/socket.io.js"></script>
        <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="/js/index.js" type="text/javascript"></script>
        <script src="/js/bootbox.min.js" type="text/javascript"></script>
        <script>
            
            $(document).ready(function(){
                bootbox.prompt("What is your name?", join_chat);
            });
            
            function join_chat(nickname){
                if (!nickname)
                    return bootbox.prompt("You must choose a nickname?", join_chat);
                
              write_output('>> connecting...');
              var socket = io.connect('/');
              socket.on('welcome', on_welcome);
              socket.on('new_message', on_new_message);
                
              function write_output(text){
                var new_msg = $("<p>"+text+"</p>");
                $("#output").append(new_msg);
              }
                
              function on_welcome(event_data){
                write_output('>> connected successfully');
                write_output('>> welcome '+nickname);
              }
                
              function on_new_message(event_data){
                write_output(event_data.text);
              }
            
              $("#send_button").click( function(ev){
                var input_text = $("#input").val();
                socket.emit('message', {text: input_text});
                $("#input").val('');
                ev.preventDefault();
                console.log(input_text);
              });
                            
            };
            
            
        </script>
    </body>
</html>
